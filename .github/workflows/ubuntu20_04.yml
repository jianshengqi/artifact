name: ubuntu_20.04
on: [push]
jobs:
  docker_hub:
    runs-on: ubuntu-20.04
    steps:
    - name: Checkout code
      uses: actions/checkout@v2
    - name: dos2unix
      run: |
          apt-get install -y dos2unix
          find . -type f | xargs dos2unix
    - name: Build and push Docker images to official hub
      uses: docker/build-push-action@v1
      with:
        username: ${{ secrets.DOCKER_USERNAME }}
        password: ${{ secrets.DOCKER_PASSWORD }}
        repository: sqjian/virtualization
        tags: "ubuntu20_04"
        dockerfile: docker/ubuntu/ubuntu20_04.dockerfile

  # aliyun_hub:
  #   runs-on: ubuntu-20.04
  #   steps:
  #   - name: Checkout code
  #     uses: actions/checkout@v2

  #   - name: Build and push Docker images to aliyun hub
  #     uses: docker/build-push-action@v1
  #     with:
  #       username: ${{ secrets.ALY_DOCKER_USERNAME }}
  #       password: ${{ secrets.ALY_DOCKER_PASSWORD }}
  #       registry: registry.cn-hangzhou.aliyuncs.com
  #       repository: jsq/virtualization
  #       tags: "ubuntu20_04"
  #       dockerfile: docker/ubuntu/ubuntu20_04.dockerfile